---
title: "コード署名用の個人用証明書を取得した話"
emoji: "🤝"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["codesigning", "azure", "certificate"]
published: false
---
## この記事は

コード署名用の個人用証明書を取得した際の記録です。

## コード署名とは

コード署名とは、ソフトウェアやスクリプトに対してデジタル署名を行い、その信頼性と整合性を保証するプロセスです。これにより、ユーザーはソフトウェアが改ざんされていないことや、信頼できる発行者からのものであることを確認できます。

例えばコード署名が無い実行形式のバイナリを実行する場合、WindowsやMacOSは警告を表示し、ユーザーに対してそのソフトウェアの信頼性を疑問視させることがあります。これにより、ユーザーは不正なソフトウェアを実行するリスクを軽減できます。

## 個人用証明書を取得したい

私は[「SORACOM LTE-M Button for Enterprise Simulator」](https://github.com/kenichiro-kimura/soracom-button/)という個人開発のプロダクトを公開しているのですが、これまでこちらで配布しているバイナリにはコード署名が施されていませんでした。そのため、SORACOM UGのハンズオンでこのプロダクトを使っていただく際に都度「警告出るけど気にしないでね」という説明をしてきました。  
これではユーザーに不安を与えてしまうため、個人用のコード署名証明書を取得しようと考え、色々と調べてみました。

## 取得先の調査

早速調査を始めたのですが、個人用のコード署名証明書を取得できるサービスは意外と少ないことが分かりました。そして、どこも高い・・・

そんな中、Microsoft Azureに[Trusted Signing](https://learn.microsoft.com/ja-jp/azure/trusted-signing/)というサービスがあることを知りました。  
こちらは月に9.99usdで個人用の証明書も取得できそうだということで、早速設定を始めたのですが、2025年5月時点では(2025年11月現在も)日本の個人が取得はできませんでした。

さらに調査を進めたところ、[CheapSSLSecurity](https://cheapsslsecurity.com/)というサイトで個人用のコード署名証明書が取得できることが分かりました。FastSSL Code Signing Certificateだと価格も1年間で149usd(単年の場合。3年契約だと年間129usd)で購入できるので、こちらを利用することにしました。

## 取得の流れ

### Azure Key Vaultの作成

取得した証明書は、ハードウェアトークンまたはクラウドサービスのトークンサービスに保存する必要があります。  
証明書購入時にトークンを郵送してもらうことはできますが追加の費用がかかるので、今回はAzure Key Vaultを作成します。  
以下のCheapSSLSecurityの公式ドキュメントを参考に作業します。

https://knowledge.cheapsslsecurity.com/support/solutions/articles/22000286612-azure-key-vault-code-signing-instructionsk

### 申し込み

[製品一覧ページ](https://cheapsslsecurity.com/sslproducts/codesigningcertificate.html)から、「FastSSL Code Signing Certificate」の「ADD TO CART」を押します。

以下のような画面が出ますが、気をつけるのは「Certificate Delivery Method」です。

![ADD TO CART](https://storage.googleapis.com/zenn-user-upload/249c41412832-20250621.png)

ヘルプドキュメントを見ると、

```
Install on Existing HSM

If you own a compatible HSM or token (FIPS 140 Level 2, Common Criteria EAL 4+, or equivalent) you can choose this option to download and install the certificate onto your device. You can also choose this option if you’re using an HSM-backed key storage solution such as Azure Key Vault or AWS KMS.
```

とありますので、ここは"Install on Existing HSM"を選びます。

### 認証

購入すると、その後デジサート・ジャパンからメールが届きます(日本語です)。身分証明書の提出を求められますので、私は運転免許証の写真をアップロードしました。  

その後、Zoomで接続しての面談を求められるので、日程を調整して面談を行います。  
面談自体は15分程度で、カメラをONにして免許証と本人の顔が一緒に写った状態で画面キャプチャを先方が保存したり、事前に送られてきたPDFを印刷したものにその場で記入(物理的に)することが求められます。

面談終了後、記入した書類の写真をアップロードしたら認証作業は終了です。

### 証明書発行

認証作業が完了したら、数日内には証明書がデジサートから送られてくるので、これをAzure Key Vaultに登録したら無事完了です。

## トラブル

・・と書くと非常にすんなりいきそうですが、実はトラブルがありました。最初の申し込みの時、私が「Certificate Delivery Method」でうっかり「Use existing token」を選んだため、証明書は発行されたものの、それを入手できないという状況に陥りました。  
「証明書を発行したからダウンロードしてね」というメールが届くものの、ダウンロードするページやそこへのアクセス方法が書かれていません。そして、CheapSSLSecurityの購入商品の詳細ページでは「トークン出荷の準備はこちらから」というボタンがあるだけでした。ここで、ようやく自分がトークンの選択を間違っていたのではないかと気づきました。

CheapSSLSecurityのサポートに連絡して、何度かやり取りをした結果なんとか解決できましたが1ヶ月近くかかってしまいました。途中でデジサートのサポートにも連絡したりで大変でしたが、辛抱強く最後まで対応してくれたサポートの方には大変感謝しています。

## まとめ

個人用のコード証明書も、149usd(複数年なら129usd)で取得でき、ハードウェアトークンの代わりにAzureやAWSのサービスも利用できることが分かりました。

私は申請の初手でミスをしたので少し時間がかかりましたが、それさえなければ数日では取得できそうです。

取得した証明書を使って実際にコード署名を行う方法については、また別の記事で紹介したいと思います。

皆様の参考になれば幸いです。
